\node CP Domain
\chapter{CP Domain}
\Author{Seungjun Lee \\
Thomas M. Parks}
\date{$Date$}

\node Installing the CP Domain
\section{Installing the CP Domain}
By default, the CP domain is not compiled into the Ptolemy
\code{pigiRpc} and \code{ptcl} programs.
\pindex{pigiRpc}
\pindex{ptcl}
Only the necessary libraries
are built.  Due to conflicts between Sun's lightweight process library
and the SDF domain, you should not include any part of the dataflow
domains (SDF, DDF, BDF, CG, CGC, etc.) in \code{pigiRpc} or
\code{ptcl}.  If you do, then you will get a core dump every time you
quit.  You may also get core dumps when running some systems.  If you
must have both the CP domain and one or more of the dataflow domains
and can accept this problem, then disregard the instructions below
about excluding the dataflow domains from \code{pigiRpc}.

To build a version of \code{pigiRpc} that includes the CP domain, you
will have to edit the files \file{makefile} and \file{defpalettes.c} in
\file{$PTOLEMY/src/pigiRpc}.  In \file{makefile}, modify the definition
of \code{LIBS} to include \samp{$(CP_LIBS)} following
\samp{$(STARLIBS)}, and \samp{$(LWP_LIBS)} after \samp{-lptolemy}.
This change causes the proper libraries to be searched when pigiRpc is
built.

\begin{example}
LIBS=     $(STAR_LIBS) $(CP_LIBS) -lsdftclstars \back
          -lrpc -lpigi -lptk -lgantt -lptolemy \back
          $(LWP_LIBS) $(OCTLIBS)
\end{example}

\begin{sloppypar}
Modify the definition of \code{LIBFILES} to include
\samp{$(CP_LIBFILES)} and \samp{$(LWP_LIBFILES)}.  This change sets up
the proper dependencies so that \code{pigiRpc} will be considered
out-of-date if any of the required library files are more recent.
\end{sloppypar}

\begin{example}
LIBFILES=  $(STAR_LIBFILES) $(CP_LIBFILES) $(LWP_LIBFILES) \back
           $(LIBDIR)/libsdftclstars.a \back
           $(LIBDIR)/libpigi.a $(LIBDIR)/libptolemy.a \back
           $(LIBDIR)/libgantt.a $(LIBDIR)/libptk.a
\end{example}

Modify the definition of \code{ALLSTARS} to include \samp{$(CPSTARS)}
and exclude all dataflow and code generation stars.  Also eliminate the
targets in \samp{ALLTARGETS}.  This causes the CP domain to be compiled
in to \code{pigiRpc}, and prevents the other domains from being
included.

\begin{example}
ALLSTARS=  $(THORSTARS) $(DESTARS) $(CPSTARS)
ALLTARGETS= 
\end{example}

In \file{defpalettes.c} add \samp{$PTOLEMY/src/domains/cp/icons/cp.pal}
to the definition of \code{defaultPalettes}.  If you wish, you may also
remove references to the palettes of unused domains, but this is not
necessary.  Also modify the value of \code{DEFAULT_DOMAIN} to refer to
a domain that will be included in  \code{pigiRpc}, such as CP.
