<!-- $Id$ -->
<html>
<head>
<Title>User's Guide to the C Editor</title>
</head>
<body bgcolor="#faf0e6">
<h1><a name="C editor">User's Guide to the C Editor</a></h1>
<p>
This class provides a text editor specialized for editing
C files.
It is invoked automatically when opening any file with the
<a name=".c extension">".c" extension</a> 
in its name.
The <a name="EditC class">EditC class</a> is derived from the
<a href="EditProgramHelp.html">EditProgram class</a>, and
therefore inherits all of its features.

<H2><A NAME="evaluating C files">Evaluating C Files</A></H2>

The C Editor can <I>evaluate</I> the current file and load it back
into Tycho by using the tcl <A
HREF="../../../../doc/itclhtml/tcl/load.n.html"><CODE>load</CODE></A>
command.  Evaluating a C file can be used to load in Tcl commands
written in C.

 <P>The C editor has a <CODE>Evaluate</CODE> choice under the
<CODE>File</CODE> menu.  The <CODE>Evaluate</CODE> choice is similar to the
<CODE>Compile</CODE> choice, except that the <CODE>Evaluate</CODE> choice
loads the shared object back into Tycho..

 <P>When a C file is evaluated, the following steps occur.
<OL>

<LI> If the Tcl <CODE>load</CODE> command is to work on a particular
file, then there must be a Tcl initialization procedure in the C file
(see below for details).  If there is no such initialization
procedure, then a dialog window will come up, asking if the user if
they want an initialization procedure added for them.

Since Tycho can't know what commands you want to register, the
initialization procedure will be blank, and the user must fill in the
body, and reevaluate the file.

<LI> The current directory is searched for the following files:
	<OL>
	<LI> <CODE>makefile</CODE>
	<LI> <CODE>Makefile</CODE>
	<LI> A file with the same base as the file being evaluated and
	a <CODE>.mk</CODE> extension.  For example, if the file being
	evaluated is named <CODE>myTclCommands.c</CODE>, then we look for 
	<CODE>myTclCommands.mk</CODE>
	</OL>

If none of the above makefiles are found, then we create a makefile
with the same basename, as #3 above.  The details of the makefile are
covered below.

<LI> A <CODE>make</CODE> command is executed with the makefile
determined from the step above.  Continuing our example above, the
command would be <CODE>make -f myTclCommand.mk</CODE>.

<LI> The Tcl <CODE>load</CODE> command is called.  The
<CODE>load</CODE> command is passed the architecture dependent shared
object filename.

</OL>

<H3>Generating a makefile</H3>

If a makefile does not exist, then when a C file is evaluated, a
makefile can be generated.  The makefile will have the same basename
as the C file, and a <CODE>.mk</CODE> extension.

 <P>The template that is used is located at <A
HREF="../../templates/Cmakefile.mk"><CODE>$TYCHO/editors/textedit/templates/Cmakefile.mk</CODE></A>.

 <P>The template includes two makefiles: <A
HREF="../../../../obj.$PTARCH/java.mk"><CODE>$TYCHO/obj.$PTARCH/java.mk</CODE></A>
and <A
HREF="../../../../obj.$PTARCH/tcl.mk"><CODE>$TYCHO/obj.$PTARCH/tcl.mk</CODE></A>
These two makefiles are generated by running <CODE>configure</CODE>.
The Tcl extensions use these file as well, see <A
HREF="../../../../doc/coding/buildtclexts.html">$TYCHO/doc/coding/buildtclexts.html</A> for details.

 <P>If these two makefiles are not present, then <CODE>make
config_tclexts</CODE> is called while in the <CODE>$TYCHO</CODE>
directory.

<H3>Initialization Procedure</H3>

The Tcl <CODE>load</CODE> command invokes an initialization procedure
after loading the shared object.  The name of the initialization
procedure depends on the file name of the shared object, or on the Tcl
package name.  See the
<A
HREF="../../../../doc/itclhtml/tcl/load.n.html"><CODE>load</CODE></A>
command for the details, but if the shared object is named <CODE>myTclCommand.so</CODE>, then the initialization procedure would be
<PRE>
int Mytclcommand_InitProc(Tcl_Interp *interp)
</PRE>

Usually the initialization procedure registers commands, for example
<PRE>
int Mytclcommand_InitProc(Tcl_Interp *interp)
{
    Tcl_CreateCommand (interp, "mytclcommand", Tcl_MyTclCommandCmd, 
                       (ClientData) infoPtr, (Tcl_CmdDeleteProc*) NULL);
    return TCL_OK;
}
</PRE>

<p>
<a href="../../../../doc/index.html">Tycho Home Page</a><br>
<p>
<HR>
Copyright &#169 1996-%Q%, The Regents of the University of California.
All rights reserved.
<br>
Last updated: $Date$,
comments to: <author>eal@eecs.berkeley.edu</author>
</body>
</html>
