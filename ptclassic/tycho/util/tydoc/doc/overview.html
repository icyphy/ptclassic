<!-- $Id$ -->
<html>
<head>
<title>Tydoc Overview</title>
</head>
<body bgcolor="#faf0e6">
<H1>Tydoc Overview</H1>
Tydoc is the Tycho documentation system.  <A HREF="../../../kernel/doc/codeDoc/index.html"><CODE>$TYCHO/kernel/doc/codeDoc/index.html</CODE></A> contains
sample tydoc output. 
	
 <P>Tydoc consists of two main parts:
<DL>
	<DT>TyDoc classes<DD>The tydoc itcl classes <CODE>DocSys</CODE>, 
	<CODE>DocClass</CODE>, <CODE>ListDocSys</CODE> and 
	<CODE>HTMLDocSys</CODE>.  These classes are defined in 
	<A HREF="../TyDoc.itcl"><CODE>$TYCHO/lib/tydoc/TyDoc.itcl</CODE></A>
	The <A HREF="../../../editors/textedit/doc/usersGuides/EditItclHelp.html">Itcl Editor</A> can load these classes to generate html documentation
	from an Itcl file.
	
	<DT><CODE>tydoc</CODE>
	<DD>A small standalone script that takes file names
	as command line arguments and converts the files to html
	output.  For example <CODE>tydoc TyDoc.itcl</CODE> would
	convert <CODE>TyDoc.itcl</CODE>
	into four files, one for each class in the
	<CODE>doc/codeDoc</CODE> directory.  If the
	<CODE>doc/codeDoc</CODE> directory does not exist, it is
	created.  A <A
	HREF="codeDoc/index.html"><CODE>index.html</CODE></A> file is
	also created in the <CODE>doc/codeDoc</CODE> directory.  The
	<CODE>index.html</CODE> file contains a menu with links to all
	of the class HTML files.
</DL>

<H2>How it works</H2>
	
Tydoc reads in an Itcl file, protects the contents of the comments
from interpretation, and then parses the file as a list into lists of
different Itcl <I>constructs</I>. An Itcl construct is a part of the
language like a class or method declaration.

<P> To produce output in different formats, we have all of the format
specific information in a child class.  Currently, we only generate HTML
output, but it could be possible to write an Itcl pretty printer that would
read in Itcl and output a cleaned up version.

<HR>
<H2><A NAME="comment format conventions">Comment Format Conventions</A></H2>

Note: this should be merged into the <A
HREF="../../../doc/coding/style.html">Tycho coding style guide</A>.

<P> Tydoc depends on certain formatting conventions to grab comment
information.
<H3>Comment formatting</H3>

In Tcl, a comment line is a line that has a <CODE>#</CODE> as the
first non-blank character.  The symbol <CODE>#</CODE> is usually
referred to as a hashmark, a poundsign or an octothorpe.  In this
document we refer to <CODE>#</CODE> as a hashmark.

 <P>Lines that contain more than one hashmark are not copied
into the <CODE>tydoc</CODE> output.

 <P>A <I>doc comment</I> is a block of comments associated
with a Itcl construct.  For a block of comments to be
associated with a construct, there must be no blank lines
between the block of comments and the construct.

 <P>A doc comment may contain <I>doc tags</I>, which consist of
a tag and a value.  For example, if we had a doc comment that looked 
like:	
<PRE>
# @Author Tycho Brahe, Claudius Ptolemaus
</PRE>
Then <CODE>@Author</CODE> would be the tag, and 
<CODE>Tycho Brahe, Claudius Ptolemaus</CODE> would be the value.

 <P>The value of a doc tag consists of all text up to the next doc tag, or
until the comment ends.
	
 <P> There are two types of doc tags, those that are file
wide, and those that are only for one particular doc comment.
(Note that much of the tag support is currently incomplete).

 <P> The text associated with a doc tag is assumed to be HTML
source. However, to make writing comments a little simpler, tydoc
applies some simple conversion rules to the text:

<ul>
<LI> Comment lines containing only white space are treated as
a new paragraph (<CODE>&lt;P&gt;</CODE>).

<LI> The underscore-as-emphasis convention is used to generate
italicized text. For example,
<PRE>
    _I_ think this is a _perfectly reasonable convention_!
</PRE>

will be converted into 

<PRE>
    &lt;i&gt;I&lt;/i&gt; think this is a &lt;i&gt;perfectly reasonable
	convention&lt;/i&gt;!
</PRE>
Which is rendered as
<p>
<dl>
    <i>I</i> think this is a <i>perfectly reasonable
	convention</i>!
</dl>


<li> Two kinds of formatting are used to generate constant-width
text for program identifiers and so on. In both of these cases, the
text can be only a single word:

<PRE>
    The method fred{} uses the global variable *rightSaid*.
</PRE>

will be converted into 

<PRE>
    The method &lt;code&gt;fred&lt;/code&gt; uses the global
    variable &lt;code&gt;rightSaid&lt;/code&gt;.
</PRE>
Which is rendered as
<P>
<DL>
    The method <code>fred</code> uses the global
    variable <code>rightSaid</code>.
</DL>

<li> If a comment doesn't end with a period, question mark,
or exclamation mark, then one is put in for you. This is useful
for catching single-line comments.

</ul>

<H3>File-wide doc tags</H3>
<DL>
	<BR><DT> <CODE>@Author</CODE>
	<DD> A list of Authors.
	
	<BR><DT> <CODE>@Version</CODE>
	<DD> Version Control System information, usually automatically
	generated by the version control system.
	
	<BR><DT> <CODE>@Copyright</CODE>
	<DD> Copyright for this file.
</DL>
<H3>Construct specific doc tags</H3>
<DL>
	<BR><DT> <CODE>@desc</CODE>
	<DD> The description of the construct.  Usually a description
	is a short one line summary.  The <CODE>desc</CODE> tag is
	optional if a doc comment has no tag, then the text is assumed
	to be a description.

	
	<BR><DT> <CODE>@expl</CODE>
	
	<DD> The explanation of the construct.  Usually an explanation
	is longer than the description.
</DL>

If a construct is declared inside a class body, and then fully defined
later in the file, outside of of a class body, usually the doc comment
associated with the declaration would be a description, and the doc
comment associated with the definition would be the explanation.  If
there is no <CODE>expl</CODE> doc tag in either doc comment, then we
assume the above.
	
 <P>

Constructs such as <CODE>proc</CODE>s that are not part of a class end
up in a file named <I>ClassName</I><CODE>_out.html</CODE>, where
<I>ClassName</I> is the name of the class defined in the file.

<H2>Tydoc output optimizations</H2>
The <CODE>tydoc</CODE> script takes a <CODE>-v</CODE> argument which will 
cause <CODE>tydoc</CODE> to generate output for all constructs in the file.
If the <CODE>-v</CODE> option is not present, then the following constructs
are <B>not</B> written to the html file:
<MENU>
<LI> All <CODE>private</CODE> constructs.  

<LI> All <CODE>option add</CODE> constructs.  In tycho, the options
mechanism will be changing, and we don't want to document the current
adhoc system.

<LI> All <CODE>option</CODE> constructs that are outside of a class.

<LI> <CODE>constructor</CODE>s and <CODE>destructor</CODE>s that don't
have comments.

</MENU>
Another optimization that always happens is that only the first line of the <CODE>@copyright</CODE> doc comment is present in the html.

<H2><A NAME="tydoc and codeDoc.idx">tydoc and codeDoc.idx</A></H2>

Classes can inherit from parent classes that are not necessarily in
the current directory.  To use create the proper links,
<CODE>tydoc</CODE> uses the <A
HREF="../../idx/codeDoc.idx"><CODE>codeDoc.idx</CODE></A> file.  

 <P>However, this represents a bit of a chicken and egg problem, as
<CODE>codeDoc.idx</CODE> is based upon the <CODE>tydoc</CODE> output.
The best solution is to create the <CODE>tydoc</CODE> output, then
create <CODE>codeDoc.idx</CODE> and then recreate the
<CODE>tydoc</CODE> output, which will use the <CODE>codeDoc.idx</CODE>
to fix cross references.  The following commands will do this for you:
<PRE>
cd $TYCHO
make install
</PRE>

 <P>
<A
HREF="../../../doc/index.html">Tycho Home Page</A>.

<HR>
Copyright &#169 1996-%Q%, The Regents of the University of California.
All rights reserved.
<br>
Last updated: $Date$,
comments to: <author>cxh@eecs.berkeley.edu</author>
</body>
</html>
