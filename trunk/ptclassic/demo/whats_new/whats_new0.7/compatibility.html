<!-- Version: $Id$
Copyright (C) 1997 The Regents of the University of California.
All rights reserved.

Permission is hereby granted, without written agreement and without
license or royalty fees, to use, copy, modify, and distribute this
software and its documentation for any purpose, provided that the above
copyright notice and the following two paragraphs appear in all copies
of this software.

IN NO EVENT SHALL THE UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY 
FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES 
ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF 
THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF 
SUCH DAMAGE.

THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE
PROVIDED HEREUNDER IS ON AN "AS IS" BASIS, AND THE UNIVERSITY OF
CALIFORNIA HAS NO OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES,
ENHANCEMENTS, OR MODIFICATIONS.
-->

<html>
<head>
<title>Backward Compatibility Issues in Ptolemy 0.7</title>
</head>
<body bgcolor=#faf0e6>

<H3>Backward Compatibility Issues in Ptolemy 0.7</H3>

<DL>

<DT> Recompilation will be necessary.
<DD> As always, if you upgrade from 0.6 to 0.7, you will need to recompile
any user designed stars.

<DT> Type system changes
<DD> The type system has been changed.  Some Code Generation universes may
need explicit conversion stars to properly compile.


<DT> Certain HOF stars have been removed
<DD> The type system changes mean that certain Higher Order Function stars have been removed.  The stars that have been removed are:
<CODE>HOFDelayedMap</CODE>
<CODE>HOFSrc</CODE><I>xxx</I> and <CODE>HOFSrcGr</CODE><I>xxx</I>
(where <I>xxx</I> is a type, such as <CODE>Int</CODE>)
If you have universes that were using the old stars, then you can update the universes with <CODE>masters</CODE> or <CODE>ptfixtree</CODE>.

<DT> <CODE>htmldoc</CODE> is a new keyword that has been added to
<CODE>ptlang</CODE>.
<DD> <CODE>ptlang</CODE> no longer generates troff output and instead
	generates html.

<DT> Certain CGC DSP stars have been moved.
<DD> To support retargeting demonstrations and galaxies from SDF to CGC, 
	Brian Evans moved the CGC stars that implemented DSP functions from
	the <CODE>cgc/stars</CODE> directory to the <CODE>cgc/dsp/stars</CODE>
	directory and
	set symbolic links from <CODE>cgc/icons</CODE>
	to <CODE>cgc/dsp/icons</CODE>
	for
	those stars for backwards compatibility.
	Users should run masters on their own CGC demos in order
	for look-inside to work.
	 <BR>Affected stars: DTMFPostTest, Dirichlet, FFTCx, FIR, FIRFix,
	GAL, GGAL, Goertzel, GoertzelBase, GoertzelPower, IIR, LMS,
	LMSOscDet, RaisedCosine, Sinc, Window.

<DT> The <CODE>cgc/targets/main</CODE> directory has been split.
<DD> To separate the uniprocessor and multiprocessor CGC targets,
	Brian Evans split the CGC <CODE>targets/main</CODE>
	directory into <CODE>targets/uniproc</CODE>
	and <CODE>targets/multiproc</CODE>

<DT> Structure of directories under <CODE>PTOLEMY_SYSTEMS</CODE>
has been changed.
<DD> To support portability between operating systems, Brian Evans changed the
	destination directory in the Ptolemy targets and demonstrations to
	<code>$HOME/PTOLEMY_SYSTEMS/<em>domain</em></code>.
	For mixed-domain demos, the <em>domain</em> was set to MIXED;
	otherwise, the <em>domain</em> was set to SDF, CGC, etc.
	Note that <code>$HOME</code> is used instead of <code>~</code>
	because POSIX-compliant Unix operating systems always define
	the HOME environment variable but do not always support ~.
	Also, it is possible to define environment variables on Macs and PCs.

<DT> Certain audio stars have been removed.
<DD> Sunil Bhave removed the old PCMread/write and 
	SunSound stars from ptdesign. Instead you can use the new
	MonoIn/Out stars, which have been added to the cgc palettes.
	The TkSunSound star is also gone.
        In Ptolemy 0.7, the mu law conversion tables are in the 
	<CODE>libptdsp</CODE> library.  If you use

<DT> A bug in float-to-int particle conversion was fixed by Tom Lane
<DD> The bug was that documentation said that float-to-int particle conversion
rounded floats to the nearest int.  In fact, the code was using 
the <CODE>int()</CODE> cast operator to truncate toward 0 for positive
values, and to truncate in a machine dependent way for negative values.
 <br>The fix was to modify the code so that floats are rounded to 
the nearest integer.
 <br> We noticed that the DE basic switch demo was
failing with a message like:
<PRE>
Error: switch.Case.output=21: The control value 2 is not in the
		range [0,1] 
</PRE>
Tom Lane's diagnosis was that the last few ramp outputs were rounding
to 2 instead of truncating to 1, so his fix was to change the lower
Ramp star from 0.1 to 0.5.

<DT> * DERepeatStar has been revised to use a delay marker rather than
setting nonstandard porthole priorities on its feedback arc.  In most
cases this will give better behavior.  Derived stars that set
delayType or contain triggers() directives may need to be revised.
DERepeatStar can also pass a numeric value in each feedback event.
See section 11.2.6 of the Programmer's Manual for details.

<DD> 

</DL>

<p>
<hr>
Up to: <A HREF="index.html">What's New in Ptolemy 0.7</A> -
Back to: <A HREF="minorchanges.html">Minor Changes in Ptolemy 0.7</A>
<address>
Last updated $Date$
Send comments to <a href="mailto:ptolemy@ptolemy.eecs.berkeley.edu">ptolemy@ptolemy.eecs.berkeley.edu</a>.
</address>
</body>
</html>
