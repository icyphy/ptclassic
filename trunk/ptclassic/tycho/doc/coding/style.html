<!-- $Id$ -->
<html>
<head>
<title>Programming Style for Tycho</title>
</head>
<body bgcolor="#faf0e6">
<h1>Programming Style for Tycho</h1>
<p>
The following programming style will be followed in the Tycho project.
Please submit comments or suggestions to eal@eecs.berkeley.edu.
<ol>
<li><a href="#indentation">Indentation</a>
<li><a href="#comment conventions">Comment conventions</a>
<li><a href="#naming conventions">Naming conventions</a>
<li><a href="#global variables">Global variables</a>
<li><a href="#documentation conventions">Documentation conventions</a>
<li><a href="#copyright conventions">Copyright and acknowledgements</a>
<li><a href="#proofreading">Proofreading </a>
</ol>

<h2><a name="indentation">Indentation</a></h2>

Tabs are 8 characters.  Do not override this in your text editor.
Nested statements should be indented 4 characters, as in:
<pre>
itcl_class MyClass {
    inherit MyParent
    constructor {config} {
        One line constructor command
    }
}
</pre>
Closing brackets should be on a line by themselves, aligned with
the beginning of the line that contains the open bracket.
<p>
Long lines (which are common especially for Tk commands)
should be broken up into many small lines.  Continuation lines
are indented by 8 characters, as in
<pre>
        $prefix.m.edit.menu add command &#92
                -label "Select All" &#92
                -underline 0 &#92
                -accelerator "C-/" &#92
                -command "$this selectall"
</pre>
Notice that the line breaks are carefully chosen so
that the options are easy to identify.  Avoid the following
variant:

<pre>
        $prefix.m.edit.menu add command &#92
                -label "Select All" &#92
                -underline 0 -accelerator "C-/" &#92
                -command "$this selectall"
</pre>
Glancing at this, it is easy to miss the <CODE>-accelerator</CODE>
option.

 <P>If you have a long <CODE>puts</CODE> statement, you can use
backslashes to make the text more readable.  Note that each backslash
introduces a space in the output.
<pre>
        puts "This is a long line&#92
             that extends over a few\n&#92
             lines"
</pre>


<h2><a name="comment conventions">Comment conventions</a></h2>

Itcl <A HREF="itclfilebody.html#itcl comment conventions"> comment
conventions</A> are described elsewhere.  However, in general,
comments should follow the guidelines below.


<MENU>
<LI> Comments should include honest information about the limitations of
the object definition.

<LI> Comments should be complete sentences and complete thoughts.

</MENU>


<h2><a name="naming conventions">Naming conventions</a></h2>

All programming languages have a global namespace.  In Itcl, class
names, global variables, and procedure names are in the global namespace.
Choose names carefully.  In particular,
<ul>
<li> All <a href="#global variables">global variables</a>
     in Tycho should begin
     with "ty" and should be documented. The documentation is
     temporarily being collected in the file "doc"
     in the main Tycho directory.
<li> All procedure names should begin with "ty" unless they already
     existed in pigi, in which case they should begin with "ptk" and
     should be backward compatible.
</ul>
In Itcl, there is no limit to name sizes (as it should be).
Do not hesitate to use long names.
<p>
When naming objects, use automatic naming as much as possible.
For any Itcl class that does not define a top-level window,
the syntax is:

<pre>
Classname #auto ?options?
</pre>

If the class defines a top-level window (i.e. it eventually inherits
the <CODE>TopLevel</CODE> class ), then you should use the syntax

<pre>
Classname [::tycho::autoname .classname] ?options?
</pre>

The <CODE>autoname</CODE> procedure is defined in Tycho and returns a
class name that is constructed by appending to the single argument an
underscore and an integer that ensures that the name will be unique.

<h2><a name="global variables">Global Variables</a></h2>

Global variables are almost entirely unnecessary in Itcl.
If you need a global variable, use a "common" variable in a class.
Note that at least one instance of the class must have been created
for the common variable to exist. (Apparently, it can have been
deleted as well).
<p>
There appears to be one circumstance in which global variables
are needed.  A Tk checkbutton object generally has a global
variable associated with it.  There appears to be no way to
use a common variable for this (that I have found).
The name of the global variable should begin with "ty",
and its existence should be documented, as explained
<a href="#naming conventions">above</a>.

<h2><a name="documentation conventions">Documentation conventions</a></h2>

The Tycho documentation layout and conventions are discussed in <A
HREF="../documentation.html">$TYCHO/doc/documentation.html</A>

<h2><a name="copyright conventions">Copyright and Acknowledgements</a></h2>

We would prefer to be able to release Tycho with the 
<A HREF="../../copyright">standard UC Berkeley copyright</A>,
which allows for subsequent commercialization.
However, this is a large project, and we should use existing
code as much as possible.  The following scenarios are possible:
<ul>
<li> An uncopyrighted program (public domain) is used either verbatim
or as inspiration.  In this case, it is essential to acknowledge the
author and institution originating the code, but this has no effect
on our copyright policy.

<li> A copylefted program (under the Gnu public license) is used
as inspiration.  If there is no verbatim code used, then it
is sufficient (and necessary) to acknowledge the author and
institution.

<li> A copylefted program or portion of a program is used verbatim.
This will place the entire Tycho program under the Gnu public license,
and therefore should be done only with good reason.  However, we are
not averse to doing this.  If you include copylefted code,
<em>be sure to identify every line of code that is borrowed in this
way</em>.  This will allow us (or someone else) to later rewrite this
code and liberate Tycho from the copyleft.

</ul>
In all cases, any foreign code that you use should be carefully
read and tested.  Yes, it should be read!
Preferably, it should be reformatted to fit our programming
style, but if it is a large piece of code, it is probably not
worth doing.  We will need to devise a scheme to avoid
confusing the automatic documentation generator.
If it is Tcl/Tk code, it <em>must</em> be ported to Tk 4.0
(a nontrivial task).  If it is not Itcl code, it should
be carefully searched for namespace violations.

 <P>If your file is based on a file that has non-UC Berkeley
copyrights, then you should be sure to include the copyrights.

<h3><a name="SCCS and copyrights">SCCS and copyrights</a></h3>

Currently we are using the <CODE>&#37Q&#37</CODE> SCCS
directive to adjust the copyright dates automatically.  The
copyright should have <CODE>&#37Q&#37</CODE>
as the ending date of the copyright:
<CODE>1990-&#37Q&#37</CODE>
If you are setting up a new directory, then you should do:
<pre>
sccs admin -fq1995 SCCS
</pre>
	
to set the <CODE>Q</CODE> variable in the SCCS directory.  Note that after
doing the sccs admin command, 'make sources' will check out
all the files in that directory.  If you are adding a new
file, you can do:
	
<pre>
sccs admin -fq1995 SCCS mynewfile.cc
</pre>

If your file is a rewrite of a previously copyrighted file from UC
Berkeley, then you should include the date from that file.

<h3><a name="copyright for Itcl files">Copyright for Itcl files</a></h3>

The <a href="../../editors/textedit/templates/ItclTemplate.itcl">Itcl
template</a> file contains the appropriate copyright to be used for
Itcl files at UC Berkeley.  Other sites may want to substitute in
their own template.  The Itcl editor has a
<A
HREF="../../editors/textedit/doc/usersGuides/EditItclHelp.html#Itcl
Editor File Template">file template menu choice</A>
that will insert the Itcl template file

<h2><a name="proofreading">Proofreading</a></h2>

Software has become a publication medium.  People will read your code.
Your name is on it, so you want to be proud of it.  It seems that most
people stop working on the code when it "works."  This is like stopping
work on a paper when what it says is correct, and not worrying at all
about how it is said.  PROOFREAD YOUR CODE AFTER YOU'VE GOTTEN IT WORKING.

<p>
<a href="../../doc/index.html">Tycho Home Page</a><br>
<HR>
Copyright &#169 1995-%Q%, The Regents of the University of California.
All rights reserved.
<br>
Last updated: $Date$,
comments to: <author>eal@eecs.berkeley.edu</author>
</body>
</html>
